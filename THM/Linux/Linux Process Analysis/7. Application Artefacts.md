During live incident investigations, analyzing application artefacts can provide valuable insights into user activities, system usage patterns, and potential security concerns. Application artefacts encompass the data generated and stored by applications during their operation, including configuration files, logs, cache files, and other user-specific data.

Understanding and analyzing these artefacts can aid forensic investigators in reconstructing events, identifying anomalies, and determining the impact of the incident. This task will cover some common application artefacts you can expect to encounter; however, the sheer volume of possibilities in the field underscores the importance of building a solid methodology.

A good first step in application artefact analysis is determining which applications or programs have been installed on the system. This can be achieved by running the `dpkg -l` command. This command will list all installed packages along with their versions:

Listing All dpkg Installed Packages

```shell-session
investigator@tryhackme:~$ sudo dpkg -l
```

However, it's important to note that this method will only list applications and programs installed through the system's package manager. Unfortunately, there is no surefire way to list manually installed programs and their components generally, which often requires more manual file system analysis.

Vim

**Vim** is a popular text editor that is included with most UNIX systems. It can sometimes leave behind artefacts that can be valuable in forensic investigations. Among these artefacts, the `.viminfo` file stands out as it contains important information about user interactions within Vim sessions. For instance, modifications to scripts or configuration files stored within Vim can be detected, shedding light on potential unauthorised access or tampering by an attacker.

Additionally, the command history stored in `.viminfo` provides a chronological record of commands executed by users and can be a valuable resource for reconstructing user activities.

To quickly list out all of the `.viminfo` files stored under the home directory, we can run the following command:

Finding .viminfo Files

```shell-session
investigator@tryhackme:~$ find /home/ -type f -name ".viminfo" 2>/dev/null
/home/janice/.viminfo
/home/ubuntu/.viminfo
```

Putting it all together, the above command searches for files named `.viminfo` starting from the home directory (`/home`). `2>/dev/null` is a common method to suppress any error messages that might occur during the search and give us a clean output.

As seen above, we have identified two `.viminfo` files on the system. Since Janice is one of our users of interest, we can analyse the file in more detail by reading its contents:

Viewing Janice's .viminfo File

```shell-session
investigator@tryhackme:~$ sudo cat /home/janice/.viminfo
# This viminfo file was generated by Vim 8.1.
# You may edit it if you're careful!

# Viminfo version
|1,4

...
# Last Search Pattern:
~MSle0~/

# Command Line History (newest to oldest):
:q
|2,0,1710339077,,"q"
...
```

As seen in the above output, several artefacts of information are stored in this file by default, including the Vim version, the encoding, the latest search pattern, command-line history, and more.

Additional text editor artefacts you may come across include `.nano_history` with **Nano** or `.emacs` or `.emacs.d` with **Emacs**, among others.

Browser Artefacts

Web browsers installed on a system, such as Mozilla Firefox and Google Chrome, generate artefacts that can provide insights into user behaviour and activities. These artefacts include browser histories, download logs, and stored cookies. Analysing browser histories and download logs can reveal websites visited, files downloaded, and potentially malicious URLs accessed by the user.

For example, **Firefox** organises user data within profile directories, often found in `~/.mozilla/firefox/`. **Google Chrome** typically stores user profiles (history, web data, login databases, etc.) in `~/.config/google-chrome/`.

Similar to our method with `.viminfo`, we can quickly list out the browser directories within the workstation's `/home` folder using this command:

Finding Browser Artefact Directories

```shell-session
investigator@tryhackme:~$ sudo find /home -type d \( -path "*/.mozilla/firefox" -o -path "*/.config/google-chrome" \) 2>/dev/null
/home/ubuntu/.mozilla/firefox
/home/eduardo/.mozilla/firefox
```

As seen in the output above, we have identified two potential locations of browser artefacts. Let's look at **Eduardo**'s Firefox directory at: `/home/eduardo/.mozilla/firefox`

The next step in our analysis is identifying the profile we need to analyse. We can list out the Firefox directory with the following syntax:

Listing Firefox Profiles

```shell-session
investigator@tryhackme:~$ sudo ls -al /home/eduardo/.mozilla/firefox
total 32
drwx------  6 eduardo eduardo 4096 Mar 13 14:44  .
drwx------  4 eduardo eduardo 4096 Mar 13 14:44  ..
drwx------  3 eduardo eduardo 4096 Mar 13 14:44 'Crash Reports'
drwx------  2 eduardo eduardo 4096 Mar 13 14:44 'Pending Pings'
-rw-r--r--  1 eduardo eduardo   62 Mar 13 14:44  installs.ini
drwx------  2 eduardo eduardo 4096 Mar 13 14:44  lwvdnf29.default
drwx------ 13 eduardo eduardo 4096 Mar 13 15:17  niijyovp.default-release
-rw-r--r--  1 eduardo eduardo  259 Mar 13 14:44  profiles.ini
```

As noted above, there are two profiles: **lwvdnf29.default** and **niijyovp.default-release**. The **.default** file is related to legacy configurations, so we can focus our efforts on the **.default-release** file.

In addition to manual inspection of browser artefacts, we can utilise specialised tools for more efficient and comprehensive analysis. Forensic tools like [Dumpzilla](https://www.dumpzilla.org/), for instance, are designed to parse and extract valuable information from browser artefacts, providing investigators with a structured overview of user activity. Dumpzilla can parse data from various web browsers and allow us to analyse browsing histories, bookmarks, download logs, and other relevant artefacts in a streamlined manner.

We have already retrieved the `dumpzilla.py` script, which can be found in `/home/investigator/dumpzilla.py`.

Dumpzilla is a very powerful tool. As mentioned, it can extract extensions, bookmarks, cookies, downloads, browsing history, and much more. Since browser profiles can contain potentially sensitive data (like cookies and passwords), we must use sudo to read profiles with elevated privileges. We can run the following syntax to pull down a summary of the data that can be extracted from Eduardo's profile:

Using Dumpzilla.py

```shell-session
investigator@tryhackme:~$ sudo python3 /home/investigator/dumpzilla.py /home/eduardo/.mozilla/firefox/niijyovp.default-release --Summary --Verbosity CRITICAL

==================
Total Information
==================

Total Addons (URLS/PATHS)  : 3
Total Addons               : 0
Total Bookmarks            : 10
Total Cookies              : 34
Total Directories          : 0
Total Downloads history    : 1
Total Search Engines       : 6
Total Forms                : 0
Total History              : 14
Total Public Key Pinning   : 9
Total Permissions          : 4
Total Preferences          : 162
Total Sessions             : 0
```

In the above output, we can list some interesting metrics. The profile has several bookmarks, cookies, and history that we can extract. By running the `--Help` argument, we can list the available extraction options. Some of the most useful ones include:

Dumpzilla.py Sample Options

```shell-session
 --Addons
 --Search
 --Bookmarks
 --Cookies
 --Downloads
 --History 
```

For example, to extract the stored **Cookies**, we can run the following command:

Extracting Cookies with Dumpzilla.py

```shell-session
investigator@tryhackme:~$ sudo python3 /home/investigator/dumpzilla.py /home/eduardo/.mozilla/firefox/niijyovp.default-release --Cookies

=======
Cookies              
=======
=> Source file: /home/eduardo/.mozilla/firefox/niijyovp.default-release/cookies.sqlite
=> SHA256 hash: f69caa997d098901992cfdd1c74c1d618d380a47f755b98539e8ec5dbb2efe3b

Host: www.mate-look.org
Name: __ocs_id
Value: ohdsjfhnrb6c8ae8rg02ha0aj5
Path: /
Expiry: 2022-03-29 16:40:22
Last Access: 2022-02-27 16:42:53
Creation Time: 2022-02-27 16:40:22
Secure: No
HttpOnly: Yes
...
```

As seen in the above output, we can list the cookies stored in Eduardo's Mozilla Firefox profile.

By analysing browsing history, search history, and cookies, Dumpzilla can help us uncover artefacts such as data that has been exfiltrated, stolen cookies, forms that may have been submitted, or potential contact with C2 servers. In conclusion, leveraging specialised forensic tools like Dumpzilla offers a more efficient and automated approach to analysing browser artefacts.

Additional Artefacts

Additional application-related artefacts that may be useful to collect during an investigation depend on the type and purpose of the system. For instance, artefacts related to email clients, word processing software, and terminal multiplexers like Screen or Tmux can provide valuable insights into a workstation. Email client artefacts may include configuration files and message stores, while word processing artefacts may encompass recently accessed documents and temporary files.

A web server's crucial artefacts may include web server logs, configuration files, and web application logs, which could contain information about accessed URLs, user agents, and server responses. Additionally, CMS artefacts, such as WordPress databases or Joomla configuration files, may offer insights into web application activity.

Similarly, artefacts such as database logs, configuration files, and SQL query logs on a database server may be useful in detailing database access and executed queries. Overall, understanding and enumerating the specific applications and services running on a system is paramount to identifying relevant artefacts for investigation.