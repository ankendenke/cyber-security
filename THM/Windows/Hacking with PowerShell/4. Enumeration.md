The first step when you have gained initial access to any machine would be to enumerate. We'll be enumerating the following:

- users
- basic networking information
- file permissions
- registry permissions
- scheduled and running tasks
- insecure files

Your task will be to answer the following questions to enumerate the machine using Powershell commands!

### 

Question 1: How many users are there on the machine?

`5` - Running `Get-LocalUser` will give us our answer

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FYPe5D7c5rarSyic6zeOg%252Fimage.png%3Falt%3Dmedia%26token%3D0e4892cb-37bb-4a2f-83b4-ee65f5f80f76&width=768&dpr=4&quality=100&sign=a773ca&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-2-which-local-user-does-this-sid-s-1-5-21-1394777289-3961777894-1791813945-501-belong-to)

Question 2: Which local user does this SID(S-1-5-21-1394777289-3961777894-1791813945-501) belong to?

`Get-LocalUser -SID "S-1-5-21-1394777289-3961777894-1791813945-501"` gives us our answer

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252F7qZY2sPraeh0Rux1qWKN%252Fimage.png%3Falt%3Dmedia%26token%3Dadbe22c4-677b-4871-978b-8234b05e7519&width=768&dpr=4&quality=100&sign=4ef84b2b&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-3-how-many-users-have-their-password-required-values-set-to-false)

Question 3: How many users have their password required values set to False?

- Run `Get-LocalUser | Where-Object -Property PasswordRequired -Match false` to find the answer.

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252F64rxHDEFZkUElH9bbBSQ%252Fimage.png%3Falt%3Dmedia%26token%3D446e4365-900e-4abd-a9ec-bd63288e55b7&width=768&dpr=4&quality=100&sign=fab44aa6&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-4-how-many-local-groups-exist)

Question 4: How many local groups exist?

 Run `Get-LocalGroup | Measure` to find the answer

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FIcgbqpo6r916VvmqOxF5%252Fimage.png%3Falt%3Dmedia%26token%3D4fa46791-0451-4ad2-913f-94802f0698ef&width=768&dpr=4&quality=100&sign=f6d4e4f0&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-5-what-command-did-you-use-to-get-the-ip-address-info)

Question 5: What command did you use to get the IP address info?

`Get-NetIPAddress`

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252Fp4pQl8zKl3vbjf7jHJVd%252Fimage.png%3Falt%3Dmedia%26token%3D49c996b5-d1d1-4a9c-8eb3-aff2a3e2d38f&width=768&dpr=4&quality=100&sign=f8142295&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-6-how-many-ports-are-listed-as-listening)

Question 6: How many ports are listed as listening?

 - Run `Get-NetTCPConnection | Where-Object -Property State -Match Listen | Measure` to find our answer.

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FfkKP3HmhWOBpsm7PGaMw%252Fimage.png%3Falt%3Dmedia%26token%3D7700dc55-111e-4fe8-abf0-ae3270c22e0e&width=768&dpr=4&quality=100&sign=bb35a769&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-7-what-is-the-remote-address-of-the-local-port-listening-on-port-445)

Question 7: What is the remote address of the local port listening on port 445?

- Running `Get-NetTCPConnection | Where-Object -Property State -Match Listen | findstr "445"` will show us our answer.

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FuSLnBoJHK8nlqkCIZnZG%252Fimage.png%3Falt%3Dmedia%26token%3Db35d6cc8-e208-438a-8f9f-86bb01ef96a1&width=768&dpr=4&quality=100&sign=c92a8582&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-8-how-many-patches-have-been-applied)

Question 8: How many patches have been applied?

 - Run `Get-Hotfix` and count OR `Get-Hotfix | Measure`

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FumcXqHunQJtRPBS152KF%252Fimage.png%3Falt%3Dmedia%26token%3Dbeb52ba3-35e4-492b-88fa-3df8e9a8f43a&width=768&dpr=4&quality=100&sign=6660fac5&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-9-when-was-the-patch-with-id-kb4023834-installed)

Question 9: When was the patch with ID KB4023834 installed?

`6/15/2017 12:00:00 AM` - In the above screenshot we can find the answer, BUT we can always run `Get-Hotfix | findstr "KB4023834"` OR `Get-Hotfix -Id KB4023834`

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-10-find-the-contents-of-a-backup-file)

Question 10: Find the contents of a backup file.

`backpassflag` - First we find the backup file `Get-ChildItem -Path C:\ -include *.bak* -File -Recurse -ErrorAction SilentlyContinue`

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FeebVlLhVDmXFy5t3syGg%252Fimage.png%3Falt%3Dmedia%26token%3D53ce46a0-8a99-4567-9098-4e4e34c61556&width=768&dpr=4&quality=100&sign=2638718f&sv=2)

Now we get the contents of that file `Get-Content 'C:\Program Files (x86)\Internet Explorer\passwords.bak.txt'`

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252F6umhQcZDqaFoXV3wS6sF%252Fimage.png%3Falt%3Dmedia%26token%3D7d540515-bac5-481d-b82e-141e69857e6b&width=768&dpr=4&quality=100&sign=3a1d49a8&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-11-search-for-all-files-containing-api_key)

Question 11: Search for all files containing API_KEY

`fakekey123` - We can run `Get-ChildItem C:* -Recurse | Select-String -pattern API_KEY` to find the answer. After a while we see an error code.

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FT0XrpoTbf2LKscJzSfkp%252Fimage.png%3Falt%3Dmedia%26token%3Dcf3da386-8305-49a9-b456-00af8c6fd810&width=768&dpr=4&quality=100&sign=fb75bb7&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-12-what-command-do-you-do-to-list-all-the-running-processes)

Question 12: What command do you do to list all the running processes?

`Get-Process`

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FUnbY3YaOvFXf146e7KTN%252Fimage.png%3Falt%3Dmedia%26token%3D06afa253-46d3-4b6b-8afa-7560a72c63c5&width=768&dpr=4&quality=100&sign=95baac59&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-13-what-is-the-path-of-the-scheduled-task-called-new-sched-task)

Question 13: What is the path of the scheduled task called new-sched-task?

`/` - We can run `Get-ScheduledTask -TaskName new-sched-task` and obtain our answer

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252FgXmQmtSTglRKulugwmv1%252Fimage.png%3Falt%3Dmedia%26token%3D1597e5ed-1d42-4d61-a4ae-f38f3a64ad14&width=768&dpr=4&quality=100&sign=89eede5a&sv=2)

### 

[](https://cybersec.th4ntis.com/tryhackme/hacking-with-powershell#question-14-who-is-the-owner-of-the-c)

Question 14: Who is the owner of the C:\?

`NT SERVICE\TrustedInstaller` - Running `Get-Acl c:/` will show us the owner.

![](https://cybersec.th4ntis.com/~gitbook/image?url=https%3A%2F%2F667808901-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FTdW22AGCceN8oUXfdlKI%252Fuploads%252F3oVWOZtDuMsLcNOYfOq9%252Fimage.png%3Falt%3Dmedia%26token%3De3d2b06b-0f6e-4f26-a02f-cde237c83242&width=768&dpr=4&quality=100&sign=660add09&sv=2)