User space logging involves capturing and analyzing log messages generated by applications, services, and user activities. The syslog system is a standard for message logging on Linux systems, facilitating the centralized collection and management of log messages from various sources. This guide will cover syslog’s components, its configuration, and a step-by-step process for analyzing syslog entries to identify system events and anomalies.

### Overview of Syslog

Syslog has evolved over time, with different daemon versions being used:

1. **syslogd:** The original daemon with basic logging capabilities.
2. **syslog-ng:** An enhanced version that provided more features such as content-based filtering, TCP transport, and complex configuration options.
3. **rsyslog:** The most recent syslog daemon with high performance, modularity and support for TLS encryption, database storage, and message modification.

Syslog consists of three main components:

1. **Syslog daemon**: The `rsyslogd` daemon (or `syslogd` in older systems) handles logging and routing messages.
2. **Configuration file**: The `/etc/rsyslog.conf` file (or `/etc/syslog.conf`) defines rules for logging, including log file locations, filtering, and message forwarding.
3. **Log files**: The actual logs are stored in the `/var/log` directory.

### Syslog Configuration

The syslog default configuration file, `/etc/rsyslog.d/50-default.conf`, controls how messages are logged. Here’s an example configuration snippet:

Syslog configuration snippet

```shell-session
# Default rules for rsyslog.
#
#         For more information see rsyslog.conf(5) and /etc/rsyslog.conf

#
# First some standard log files.  Log by facility.
#
#Save authentication logs
auth,authpriv.*                 /var/log/auth.log

*.*;auth,authpriv.none          -/var/log/syslog

# Log cron jobs separately
cron.*                         /var/log/cron.log

#daemon.*                       -/var/log/daemon.log
# Log all kernel messages to /var/log/kern.log

kern.*                          -/var/log/kern.log
#lpr.*                          -/var/log/lpr.log
mail.*                          -/var/log/mail.log
#user.*                         -/var/log/user.log
```

  

Additionally, it is important to understand the architecture used for logging systems. The main components of the architecture are:

- **Originator**: This is also known as the _syslog client_ and is responsible for sending the syslog messages over the network or to the required application.
- **Relay**: This is used to forward messages over the network. A relay can modify the messages to enrich them, such as when used in Logstash.
- **Collector**: This is also known as the _syslog server_ and is used to store, visualise, and retrieve logs from different applications.

Furthermore, according to [RFC 5424](https://www.rfc-editor.org/info/rfc5424), the syslog message format comprises three parts:

1. **PRI:** This part details the message priority value, a combination of facility and severity levels. It appears at the beginning of the message.
2. **Header:** Composed of several fields, including:

- **TIMESTAMP:** The time the message was generated.
- **HOSTNAME:** The name of the machine that generated the log.
- **APP-NAME:** The name of the application responsible for the message.
- **PROCID:** The process ID.
- **MSGID:** A unique identifier for the message.

4. **MSG:** This part details the actual information about the event recorded.

  

### Syslog Severity and Facilities Levels

Syslog messages have associated severity levels and facilities that determine the program or part of the host that produced the logs. As you may notice, the severity levels used within a Linux system are the same whether on kernel or user logging:

**Severity levels**: Indicate the severity of the message.

|Value|Severity|Keyword|Description|
|---|---|---|---|
|0|Emergency|emerg|System is unusable|
|1|Alert|alert|Immediate action needed|
|2|Critical|crit|Critical conditions|
|3|Error|err|Error conditions|
|4|Warning|warning|Warning conditions|
|5|Notice|notice|Normal but significant|
|6|Informational|info|Informational messages|
|7|Debug|debug|Debug-level messages|

**Facilities**: Indicate the source of the message. There are 24 different syslog facilities that can be described below:

|Numerical Code|Keyword|Facility Name|
|---|---|---|
|0|kern|Kernel messages|
|1|user|User-level messages|
|2|mail|Mail system|
|3|daemon|System daemons|
|4|auth|Security/authentication messages|
|5|syslog|Internal syslog messages|
|6|lpr|Line printer subsystem|
|7|news|Network news subsystem|
|8|uucp|UUCP subsystem|
|9|cron|Cron subsystems|
|10|authpriv|Security messages|
|11|ftp|FTP daemon|
|12|ntp|NTP subsystem|
|13|security|Security log audit|
|14|console|Console log alerts|
|15|solaris-cron|Scheduling logs|
|16-23|local0 to local7|Locally used facilities|

The local facilities are used if a third party wants to issue a log.