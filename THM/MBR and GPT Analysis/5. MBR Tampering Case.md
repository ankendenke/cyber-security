## Scenario

An organization's critical database server suddenly became unbootable, causing widespread panic. The initial investigation found an employee opened a malicious email attachment, prompting a reboot. The employee rebooted the system, after which the system became completely unbootable. Most of the clues point to the malware's deliberate corruption of the server's Master Boot Record (MBR).

A quick look at the server's MBR points to two corruptions. One of them is the logical address of the first partition, which was previously `00 08 00 00`, and the other is a critical component of the MBR that must be the same across all the MBRs. Fixing these corrupted bytes will make the system bootable again, which can be verified by re-opening the fixed disk image using FTK Imager.

## Instructions

In this task, you will utilize two tools, FTK Imager and HxD. Both tools are available in the taskbar and Desktop of the machine.

HxD

HxD is a hexadecimal editor. You can view the MBR contents of a disk by opening it into the hexadecimal editor, just as we did in task #3. In this task, you will use HxD to examine the corrupted hexadecimal bytes of the MBR and fix these bytes by following the clues in the scenario. The disk under examination is placed at `C:\Analysis\MBR_Corrupted_Disk.001`. Open this disk image using the HxD tool.  Now, to fix the corrupted bytes, you can click on the corrupted byte and type the new correct one. Once you are done with replacing all the corrupted bytes, save the disk image using the `Save` button located in the dropdown of the `File` option, as shown in a sample screenshot below:

!["Save" feature of HxD to save changes.](https://tryhackme-images.s3.amazonaws.com/user-uploads/6645aa8c024f7893371eb7ac/room-content/6645aa8c024f7893371eb7ac-1737107623828.png)  

**Note:** You may encounter an error message that says: **"There is not enough space on the disk."** while saving the changes. This is because HxD creates a backup of the original file before saving the changes, and due to insufficient space, it cannot make a backup. However, it does not stop you from saving the file. It gives you the option to save anyway. Click **Yes** to proceed, and the file will be saved without the backup creation.

Now, as the corrupted bytes are fixed and saved into the disk image, open the fixed disk image using FTK Imager (guideline given ahead) and verify that you can see all the contents of the disk. If the disk contents are properly available, the corrupted MBR is recovered, and the disk is ready to boot again.

FTK Imager

FTK Imager is a forensics tool that you can use to create or examine a disk image's contents. The infected disk image was preserved immediately after the attack by booting the system with a live USB. You are provided with this disk image and you can use FTK Imager to test and examine its content. Initially, before you deploy the fix, this disk image, when opened with FTK Imager, will show the error "Unrecognized file system." However, once the disk's MBR is fixed, you will be able to examine the contents of the whole disk in the FTK Imager.

To open a disk image using FTK Imager, you need the following steps:

Click on the `File` button available in the options tab and then choose `Add Evidence Item`.

!["Add Evidence Item" feature of FTK Imager to add an evidence.](https://tryhackme-images.s3.amazonaws.com/user-uploads/6645aa8c024f7893371eb7ac/room-content/6645aa8c024f7893371eb7ac-1733910121279.png) 

Now, select the `Image File` option and click the `Next` button.

![Selecting "Image File" option since our file is a disk image.](https://tryhackme-images.s3.amazonaws.com/user-uploads/6645aa8c024f7893371eb7ac/room-content/6645aa8c024f7893371eb7ac-1733910121296.png)  

Lastly, enter the source path of the image file and click the `Finish` button to view the contents of the disk image.

![Disk Image loaded into the "Select File" option.](https://tryhackme-images.s3.amazonaws.com/user-uploads/6645aa8c024f7893371eb7ac/room-content/6645aa8c024f7893371eb7ac-1737107623837.png)  

The left pane would display the disk image in a tree format. You can expand the contents of the disk by clicking the + icon. Currently, it displays `Unrecognized file system` as the disk's MBR is corrupted. The right pane will give you the contents and details of the files and folders you select inside the left pane.

![Two different panes of the FTK Imager.](https://tryhackme-images.s3.amazonaws.com/user-uploads/6645aa8c024f7893371eb7ac/room-content/6645aa8c024f7893371eb7ac-1737107623829.png)  

Answer the questions below