In Windows, an **unquoted service path** is a vulnerability that occurs when the path to an executable for a Windows service is not enclosed in double quotes (`""`). This becomes a problem when the path contains spaces because Windows will attempt to locate the executable by checking each part of the path in sequence, potentially leading to a [[Windows Privilege Escalation]] vulnerability. Here's how you can understand and approach it as a security researcher:

### 1. **Understanding the Risk**
   - Windows services often run with elevated privileges, including **SYSTEM** or **Administrator**.
   - If a service's path contains spaces and is not properly quoted, an attacker could place a malicious executable in a location that Windows might mistakenly attempt to execute, thus running it with high privileges.

   For example, consider the service path:
   ```
   C:\Program Files\My Service\service.exe
   ```
   If this path is not quoted and you try to start the service, Windows may interpret it as:
   1. `C:\Program.exe`
   2. `C:\Program Files\My.exe`
   3. `C:\Program Files\My Service\service.exe`

   If `C:\Program.exe` or `C:\Program Files\My.exe` exists, it will be executed instead of the intended `service.exe`, which may allow an attacker to gain elevated privileges by placing a malicious file in those locations.

### 2. **Identifying Unquoted Service Paths**
   To find unquoted service paths, you can manually inspect the system services or use PowerShell or other security tools.

   **Using PowerShell**:
   Run the following command to list services and check their paths:
   ```powershell
   Get-WmiObject win32_service | Select-Object Name, PathName | Where-Object {$_.PathName -notlike '*"*"'}
   ```
   This command will output the services that do not have a properly quoted executable path.

   **Using sc.exe**:
   You can also use `sc.exe` to query a specific service:
   ```cmd
   sc qc "ServiceName"
   ```
   Look for the **BINARY_PATH_NAME** and check if the path is quoted.

### 3. **Exploitation**
   - If you discover an unquoted service path, you can potentially exploit it by placing a malicious executable in one of the preceding paths (e.g., `C:\Program.exe` or `C:\Program Files\My.exe`).
   - This type of attack can lead to **privilege escalation** if you can get your malicious executable executed with the same privileges as the service (e.g., SYSTEM or Administrator).

### 4. **Mitigation**
   - **Properly quote all service paths**: Ensure that service paths are enclosed in double quotes, especially if the path contains spaces. As an administrator, this can be fixed manually by editing the service configuration.
   - **Use tools to automatically check and alert**: As part of vulnerability management, use security tools that can automatically scan for and alert on unquoted service paths.

### 5. **Testing with a Red Team Mindset**
   - When testing, consider services that start automatically or on-demand, as these are the most likely candidates for exploitation.
   - Check if you have write permissions to any of the directories in the unquoted path sequence, which would allow you to place a malicious executable there.

This is a common vulnerability in misconfigured services and can be easy to exploit, making it important to look for during audits and red team assessments.